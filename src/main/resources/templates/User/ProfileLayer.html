<div xmlns:th="http://www.thymeleaf.org" 
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{Common/LayoutModal}">
    
    <th:block layout:fragment="modalTitle">
        회원 상세
    </th:block>

	<th:block layout:fragment="modalContent">
	<form id="updateUserForm" th:object="${item}">
		<input type="hidden" th:field="*{userNo}">
        <table class="w-full border-collapse">
		    <tbody>
	            <!-- ID -->
	            <tr>
	                <td class="w-1/4 font-medium p-2"><label for="id">아이디</label></td>
	                <td class="w-3/4 p-2">
	                    <input type="text" readonly th:field="*{id}" required
	                    	class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-400" >
	                </td>
	            </tr>
	
	            <!-- 비밀번호 -->
	            <tr>
	                <td class="font-medium p-2">비밀번호</td>
	                <td class="p-2">
	                    <input type="password" th:field="*{pw}" placeholder="숫자, 영문, 특수문자 중 2가지 이상" onblur="confirmJoinInput()"
	                    	class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-400" minlength="6" maxlength="20" required>
	                    <p id="passwordError" class="text-sm text-red-500 mt-1 hidden">비밀번호 규칙을 확인하세요.</p>
	                </td>
	            </tr>
	
	            <!-- 비밀번호 확인 -->
	            <tr>
	                <td class="font-medium p-2">비밀번호 확인</td>
	                <td class="p-2">
	                    <input type="password" id="confirmPassword" placeholder="최소 6자, 최대 20자" onblur="confirmJoinInput()"
	                    	class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-400" required>
	                    <p id="confirmPasswordError" class="text-sm text-red-500 mt-1 hidden">비밀번호가 일치하지 않습니다.</p>
	                </td>
	            </tr>
	            <tr>
		            <td class="font-medium p-2">별명</td>
		                <td class="p-2 flex items-center">
		                	<input type="text" th:field="*{nickname}" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-400" minlength="1" maxlength="20" required>
		                	<div class="relative ml-4">
	                			<script th:replace="~{Common/ProfileImg :: imageEle( userNo='0', userId='프로필이미지' )}"></script>
		                	</div>
		                </td>
		            </tr>
	
	            <th:block th:replace="~{Auth/AuthHint :: AuthHint}"></th:block>
	        </tbody>
	    </table>
    </form>
    </th:block>
    
    
    <th:block layout:fragment="modalScript">
    
    	<script th:replace="~{Common/ProfileImg :: script}"></script>
    	
		<script>
		
		function comparePassword(){
			const password = document.getElementById("password").value;
            const confirmPassword = document.getElementById("confirmPassword").value;
            const passwordError = document.getElementById("passwordError");
            const confirmPasswordError = document.getElementById("confirmPasswordError");
            
            // 비밀번호 검사 (숫자, 영문, 특수문자 중 2가지 이상 포함)
            const hasNumber = /[0-9]/.test(password);
            const hasLetter = /[a-zA-Z]/.test(password);
            const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);
            const isValidPassword = (hasNumber && hasLetter) || (hasNumber && hasSpecial) || (hasLetter && hasSpecial);

            if (!isValidPassword || password.length < 6 || password.length > 20) {
                passwordError.classList.remove("hidden");
                return;
            } else {
                passwordError.classList.add("hidden");
            }

            if( password.length > 0 & confirmPassword.length > 0 ){
                // 비밀번호 확인 검사
                if (password !== confirmPassword) {
                    confirmPasswordError.classList.remove("hidden");
                } else {
                    confirmPasswordError.classList.add("hidden");
                }
            }
		}

		document.addEventListener('DOMContentLoaded', () => {
			document.getElementById('myRainbow').removeAttribute('required');
			document.getElementById('mySeason').removeAttribute('required');
			document.getElementById('myNumber').removeAttribute('required');

			document.getElementById("password").addEventListener("blur", comparePassword);
			document.getElementById("confirmPassword").addEventListener("blur", comparePassword);
        });
		
		 // 데이터 저장
         function saveData() {
			alert('Save');
		 }
		</script>
    </th:block>
</div>
	   

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Tailwind ìš°í´ë¦­ ë©”ë‰´</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="h-screen bg-gray-100">

  <!-- ì»¤ìŠ¤í…€ ìš°í´ë¦­ ë©”ë‰´ -->
  <ul id="contextMenu" class="absolute hidden bg-white border border-gray-300 shadow-lg rounded-md w-56 text-sm z-50">
    <li class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer" onclick="handleOpen()">
      <span class="mr-2">ğŸ“‚</span> ì—´ê¸°
    </li>
    <hr class="my-1 border-gray-200">

    <li class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer" onclick="handleCut()">
      <span class="mr-2">âœ‚ï¸</span> ì˜ë¼ë‚´ê¸°
    </li>
    <li class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer" onclick="handleCopy()">
      <span class="mr-2">ğŸ“„</span> ë³µì‚¬
    </li>
    <li class="flex items-center px-4 py-2 hover:bg-gray-100 text-gray-400 cursor-not-allowed"
    	data-action="paste" onclick="handlePaste()">
    	<span class="mr-2">ğŸ“‹</span> ë¶™ì—¬ë„£ê¸°
    </li>

    <hr class="my-1 border-gray-200">

    <li class="flex items-center px-4 py-2 hover:bg-gray-100 cursor-pointer" onclick="handleDetail()">
      <span class="mr-2">âš™ï¸</span> ì†ì„±
    </li>
  </ul>

  <script>
  
  function handleOpen() {
	  if (!contextTargetNode) return;
	  storageInstance.doDirectoryClick(contextTargetNode);
	}

	function handleCut() {
	  if (!contextTargetNode) return;
	  storageInstance.directoryCut(contextTargetNode);
	}

	function handleCopy() {
	  if (!contextTargetNode) return;
	  storageInstance.directoryCopy(contextTargetNode);
	}

	function handlePaste() {
	  storageInstance.paste();
	}
	
	function handleDetail() {
		storageInstance.paste();
	}
	
const contextMenu = document.getElementById("contextMenu");


document.addEventListener("contextmenu", (e) => {
  e.preventDefault();

  const nodeElem = e.target.closest("[data-node]");
  if (!nodeElem) return;

  contextTargetNode = JSON.parse(nodeElem.dataset.node);

  // ë¶™ì—¬ë„£ê¸° í™œì„±í™”/ë¹„í™œì„±í™” ì„¤ì •
  const canPaste = storageInstance?.hasClipboardData?.() ?? false;

  const pasteItem = contextMenu.querySelector('[data-action="paste"]');
  if (canPaste) {
    pasteItem.classList.remove("text-gray-400", "cursor-not-allowed");
    pasteItem.classList.add("cursor-pointer");
  } else {
    pasteItem.classList.add("text-gray-400", "cursor-not-allowed");
    pasteItem.classList.remove("cursor-pointer");
  }

  contextMenu.style.top = `${e.clientY}px`;
  contextMenu.style.left = `${e.clientX}px`;
  contextMenu.classList.remove("hidden");
});
</script>

</body>
</html>

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
	<meta charset="UTF-8">
	<title th:text="'? BurrowNest - ' + ${fileName}">Streaming</title>
	<link rel="stylesheet" th:href="@{/css/tailwind/tailwind.min.css}">
	<th:block th:replace="~{Common/Favicon :: Favicon}"></th:block>
	<!-- <script type="text/javascript" th:src="@{/js/tailwind/tailwind.min.js}"></script> -->
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">
	<div class="w-full max-w-5xl">
		<!-- Video 영역 -->
		<div th:if="${mimeType.startsWith('video')}" class="relative bg-black rounded shadow overflow-hidden">
			<video id="player" class="w-full h-auto rounded" controls autoplay>
				<source th:src="@{/File/Stream(path=${path})}" th:type="${mimeType}" />
				    해당 브라우저는 비디오를 지원하지 않습니다.
			</video>
		</div>

		<!-- Audio 영역 -->
		<div th:if="${mimeType.startsWith('audio')}" class="bg-gray-800 rounded p-6 shadow">
			<audio id="player" class="w-full" controls autoplay>
				<source th:src="@{/File/Stream(path=${path})}" th:type="${mimeType}" />
				    해당 브라우저는 오디오를 지원하지 않습니다.
			</audio>
		</div>

		<!-- 컨트롤 패널 -->
		<div class="mt-4 flex flex-col sm:flex-row justify-between items-center gap-4">
			<div class="text-gray-300">
				<div class="text-lg font-bold" th:text="${fileName}">파일명</div>
				<div class="text-sm" th:text="${mimeType}">파일타입</div>
			</div>

			<div class="flex gap-2 items-center">
				<!-- 배속 -->
				<label for="speed" class="text-sm text-gray-400">재생 속도</label>
				<select id="speed" class="bg-gray-800 border border-gray-600 rounded text-sm px-2 py-1 text-white">
					<option value="0.5">0.5x</option>
					<option value="0.8">0.8x</option>
					<option value="1" selected>1x</option>
					<option value="1.2">1.2x</option>
					<option value="1.5">1.5x</option>
					<option value="2">2x</option>
				</select>
				
				<!-- 전체화면 버튼 -->
				<button id="fullscreenBtn" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm">
					전체화면
				</button>
			</div>
		</div>
	</div>

	<script>
	const videoPlayer = document.getElementById("player");
	
	if (videoPlayer) {
		
		const speedControl = document.getElementById("speed");
		const fullscreenBtn = document.getElementById("fullscreenBtn");
		
		speedControl.addEventListener("change", (e) => {
			videoPlayer.playbackRate = parseFloat(e.target.value);
		});
	
		fullscreenBtn.addEventListener("click", () => {
			if (videoPlayer.requestFullscreen) {
				videoPlayer.requestFullscreen();
			} else if (videoPlayer.webkitRequestFullscreen) {
			  	videoPlayer.webkitRequestFullscreen();
			} else if (videoPlayer.msRequestFullscreen) {
			  	videoPlayer.msRequestFullscreen();
			}
		});
	}
	</script>
</body>
</html>

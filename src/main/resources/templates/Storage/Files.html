<div xmlns:th="http://www.thymeleaf.org" th:fragment="files"
     class="p-2 text-sm bg-white text-black select-none h-full w-full overflow-hidden">
<div class="w-full h-screen flex flex-col">
  <!-- 보기 전환 버튼 -->
  <div class="flex justify-end p-2 gap-2 border-b border-gray-300">
    <button class="px-3 py-1 border rounded hover:bg-gray-100" id="detailViewBtn">상세보기</button>
    <button class="px-3 py-1 border rounded hover:bg-gray-100" id="iconViewBtn">큰 아이콘 보기</button>
  </div>

  <!-- 파일/폴더 목록 -->
  <div class="flex-1 overflow-auto p-4">
    <div class="grid grid-cols-10 gap-4" id="fileGrid">
      <!-- 항목이 여기에 렌더링됨 -->
    </div>
  </div>
</div>

<script th:inline="javascript">
  const fileGrid = document.getElementById('fileGrid');
  let selectedItems = new Set();

  // 파일 리스트 가져오기
  async function loadFileList(uid) {
	  
    try {
      const res = await fetch("/Dir/FileList.json?uid="+ uid);
      const list = await res.json(); // [{ name, type }, ...]
      renderFileList(list);
    } catch (err) {
      console.error("파일 목록 불러오기 실패:", err);
    }
  }

  function renderFileList(list) {
    fileGrid.innerHTML = ''; // 초기화
    for (const item of list) {
      const div = document.createElement('div');
      div.className = 'file-item flex flex-col items-center p-2 border border-gray-200 rounded hover:bg-blue-50 cursor-pointer';
      div.dataset.name = item.name;
      div.dataset.type = item.type;

      div.innerHTML = `
        <div class="w-16 h-16 bg-gray-100 rounded overflow-hidden">
          ${item.type === 'image'
            ? `<img src="/thumbnail/${encodeURIComponent(item.name)}" class="w-full h-full object-cover" loading="lazy" />`
            : `<div class="flex items-center justify-center h-full text-gray-400">
                 <i class="fa-solid fa-file"></i>
               </div>`
          }
        </div>
        <div class="text-sm text-center mt-2 truncate w-20">${item.name}</div>
      `;
      fileGrid.appendChild(div);
    }
  }

  // 선택 기능
  fileGrid.addEventListener('click', (e) => {
    const item = e.target.closest('.file-item');
    if (!item) return;

    const name = item.dataset.name;

    if (e.ctrlKey) {
      if (selectedItems.has(name)) {
        selectedItems.delete(name);
        item.classList.remove('bg-blue-200');
      } else {
        selectedItems.add(name);
        item.classList.add('bg-blue-200');
      }
    } else {
      document.querySelectorAll('.file-item').forEach(el => el.classList.remove('bg-blue-200'));
      selectedItems.clear();
      selectedItems.add(name);
      item.classList.add('bg-blue-200');
    }
  });

</script>


</div>
